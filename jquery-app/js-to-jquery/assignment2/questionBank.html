<!DOCTYPE html>
<html>

<head>
    <title>Online Test</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>

<body>
    <table align="center">
        <tr>
            <th>
                <h1>Online Test</h1>
            </th>
        </tr>
        <tr>
            <td align="center">
                <button id="start">Start Online Test</button>
            </td>
        </tr>
        <tr>
            <td>
                <div id="question-list"></div>
            </td>
        </tr>
        <tr>
            <td align="center">
                <div id="result"></div>
            </td>
        </tr>
        <tr>
            <td align="center">
                <button id="submit">Submit</button>
            </td>
        </tr>
    </table>


    <script>

        $(document).ready(function () {
            'use strict'

            var questionList = $('#question-list'); // document.getElementById('question-list');
            var start = $('#start'); //document.getElementById('start');
            var submit = $('#submit'); //document.getElementById('submit');
            var result = $('#result'); // document.getElementById('result');
            var questions = {};
            var questionSequence;
            var score = 0;

            start.click(startTest);
           // start.addEventListener('click', startTest);
            submit.click(submitTest); //.addEventListener('click', submitTest);

            //start.style.display = "inline-block";
            //overAllTime.style.display = "block";
            submit.hide();
            //submit.style.display = "none";

            function startTest() {
                start.hide(); //style.display = "none";
                submit.hide(); //style.display = "none";
                result.hide();// style.display = "none";

                score = 0;

                var xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function () {
                    if (this.readyState == 4 && this.status == 200) {
                        questions = JSON.parse(this.responseText);
                        questionSequence = [];
                        getRandomQuestion();
                        getQuestionList();
                    }
                };
                xhttp.open("GET", "question-list.json", true);
                xhttp.send();
            }

            function getRandomQuestion() {
                var random = Math.round((Math.random() * 5) % 4);
                if (questionSequence.length != 5) {
                    questionSequence.push(random);
                    getRandomQuestion();
                }
            }

            function getQuestionList() {

                questionList.html('');
                //questionList.innerHTML = "";

                for (var i in questionSequence) {
                    var icopy = parseInt(i) + 1;
                    questionList.html(questionList.html()+
                    '<br>(' + icopy + ')<label>' + questions[questionSequence[i]].question +
                    '</label><br>');
                    //questionList.innerHTML += ;

                    for (var key in questions[questionSequence[i]].options) {
                        questionList.html(questionList.html()+
                        '<input type="radio" class="answers" id="question' + questionSequence[i] + 
                        '">' + questions[questionSequence[i]].options[key] + '<br>');
                       // questionList.innerHTML += '<input type="radio" class="answers" id="question' + questionSequence[i] + '">' + questions[questionSequence[i]].options[key] + '<br>';
                    }

                    questionList.show(); //style.display = "block";
                    submit.show(); //.style.display = "inline-block";
                }
            }

            function submitTest() {

                submit.hide(); //.style.display = "none";
                questionList.hide(); //style.display = "none";
                start.show();// style.display = "block";
                result.show(); //style.display = "block";

                result.html('<h3 align="center">Your score: ' + percentageCalculator() + '%</h3>');
                //result.innerHTML = '<h3 align="center">Your score: ' + percentageCalculator() + '%</h3>';
                start.html("Restart Test");
                //start.innerHTML = "Restart Test";
            }

            function percentageCalculator() {
                for (var i in questionSequence) {
                    var answerArray = questionList.find('.answers') //querySelectorAll('.answers');
                    var selectedAnswer = (answerArray[i].find('input[name=question' + i + ']:checked') || {}).val();
                    if (selectedAnswer != undefined && questions[questionSequence[i]].answer == selectedAnswer) {
                        score++;
                    }
                }

                return (score * 100) / questions.length;
            }
        });

    </script>
</body>

</html>